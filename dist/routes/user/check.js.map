{"version":3,"sources":["../../../routes/user/check.js"],"names":["jwt","require","express","router","Router","http","checkToken","get","req","res","next","headers","token","split","decoded","decode","exp","Date","now","json","status","error","module","exports"],"mappings":";;AAAA,IAAMA,MAAMC,QAAQ,cAAR,CAAZ;AACA,IAAMC,UAAUD,QAAQ,SAAR,CAAhB;AACA,IAAME,SAASD,QAAQE,MAAR,EAAf;AACA,IAAMC,OAAOJ,QAAQ,MAAR,CAAb;AACA,IAAMK,aAAaL,QAAQ,uBAAR,CAAnB;;AAGA;AACAE,OAAOI,GAAP,CAAW,GAAX,EAAgB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACtC,QAAIF,IAAIG,OAAJ,CAAY,eAAZ,CAAJ,EAAkC;;AAE9B,YAAIC,QAAQJ,IAAIG,OAAJ,CAAY,eAAZ,EAA6BE,KAA7B,CAAmC,GAAnC,EAAwC,CAAxC,CAAZ;AACA;AACA,YAAIC,UAAUd,IAAIe,MAAJ,CAAWH,KAAX,CAAd;AACA;AACA,YAAIA,SAASE,QAAQE,GAAR,IAAeC,KAAKC,GAAL,KAAa,IAAzC,EAA+C;AAC3C,mBAAOT,IAAIU,IAAJ,CAAS;AACZC,wBAAQ,OADI;AAEZR,uBAAO,KAFK;AAGZS,uBAAO;AAHK,aAAT,CAAP;AAKH,SAND,MAMO;AACH,mBAAOZ,IAAIU,IAAJ,CAAS;AACZC,wBAAQ,SADI;AAEZR,uBAAO;AAFK,aAAT,CAAP;AAIH;AACJ;;AAED;AACH,CAtBD;;AAwBAU,OAAOC,OAAP,GAAiBpB,MAAjB","file":"check.js","sourcesContent":["const jwt = require('jsonwebtoken')\r\nconst express = require('express');\r\nconst router = express.Router();\r\nconst http = require('http')\r\nconst checkToken = require('../../util/checktoken')\r\n\r\n\r\n/* login. */\r\nrouter.get('/', function (req, res, next) {\r\n    if (req.headers['authorization']) {\r\n\r\n        let token = req.headers['authorization'].split(' ')[1]\r\n        //    解构token\r\n        let decoded = jwt.decode(token)\r\n        //测试是否超时\r\n        if (token && decoded.exp <= Date.now() / 1000) {\r\n            return res.json({\r\n                status: 'ERROR',\r\n                token: false,\r\n                error: '登录超时，请重新登录！'\r\n            })\r\n        } else {\r\n            return res.json({\r\n                status: 'SUCCESS',\r\n                token: true\r\n            })\r\n        }\r\n    }\r\n\r\n    // next()\r\n});\r\n\r\nmodule.exports = router;"]}