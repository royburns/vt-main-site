{"version":3,"sources":["../../../routes/user/login.js"],"names":["express","require","router","Router","createToken","findData","post","req","res","next","body","username","password","json","status","message","then","param","userInfo","token","catch","console","log","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,SAASF,QAAQG,MAAR,EAAf;AACA,IAAMC,cAAcH,QAAQ,wBAAR,CAApB;AACA,IAAMI,WAAWJ,QAAQ,yBAAR,CAAjB;;AAGA;AACAC,OAAOI,IAAP,CAAY,GAAZ,EAAiB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACvC;AACA;AACA;AACA;AAJuC,oBAKZF,IAAIG,IALQ;AAAA,QAKlCC,QALkC,aAKlCA,QALkC;AAAA,QAKxBC,QALwB,aAKxBA,QALwB;;;AAOvC,QAAI,CAACD,QAAL,EAAe;;AAEXH,YAAIK,IAAJ,CAAS;AACLC,oBAAQ,OADH;AAELC,qBAAS;AAFJ,SAAT;AAIH,KAND,MAMO;AACH;AACA;AACAV,iBAASM,QAAT,EAAmBK,IAAnB,CAAwB,UAACC,KAAD,EAAW;AAC/B,gBAAIC,WAAWD,MAAM,CAAN,CAAf;AACA,gBAAIN,aAAaO,SAAS,UAAT,CAAb,IAAqCN,aAAaM,SAAS,UAAT,CAAtD,EAA4E;AACxEV,oBAAIK,IAAJ,CAAS;AACLC,4BAAQ,SADH;AAELC,6BAAS,MAFJ;AAGLJ,8BAAUJ,IAAIG,IAAJ,CAASC,QAHd;AAILQ,2BAAOf,YAAYO,QAAZ;AAJF,iBAAT;AAMH,aAPD,MAOO;AACHH,oBAAIK,IAAJ,CAAS;AACLC,4BAAQ,OADH;AAELC,6BAAS;AAFJ,iBAAT;AAIH;AACJ,SAfD,EAgBKK,KAhBL,CAgBW,UAACH,KAAD,EAAW;AACdI,oBAAQC,GAAR,CAAYL,KAAZ;AACH,SAlBL;AAoBH;AACJ,CArCD;;AAuCAM,OAAOC,OAAP,GAAiBtB,MAAjB","file":"login.js","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst createToken = require('../../util/createtoken')\r\nconst findData = require('../../util/mongodb/find')\r\n\r\n\r\n/* login. */\r\nrouter.post('/', function (req, res, next) {\r\n    // console.log(req.headers['authorization']);\r\n    // let username = req.body.username\r\n    // let password = req.body.password\r\n    // 学会解构赋值\r\n    let {username, password} = req.body\r\n\r\n    if (!username) {\r\n\r\n        res.json({\r\n            status: 'ERROR',\r\n            message: '此用户不存在！'\r\n        })\r\n    } else {\r\n        //    用户名和密码正确  返回正确信息  并创建token\r\n        // let username = req.body.username\r\n        findData(username).then((param) => {\r\n            let userInfo = param[0]\r\n            if (username === userInfo['username'] && password === userInfo['password']) {\r\n                res.json({\r\n                    status: 'SUCCESS',\r\n                    message: '登陆成功',\r\n                    username: req.body.username,\r\n                    token: createToken(username)\r\n                })\r\n            } else {\r\n                res.json({\r\n                    status: 'ERROR',\r\n                    message: '用户名或者密码错误'\r\n                })\r\n            }\r\n        })\r\n            .catch((param) => {\r\n                console.log(param)\r\n            })\r\n\r\n    }\r\n});\r\n\r\nmodule.exports = router;"]}