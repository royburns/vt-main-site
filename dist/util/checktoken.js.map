{"version":3,"sources":["../../util/checktoken.js"],"names":["jwt","require","module","exports","req","res","next","headers","token","split","console","log","decoded","decode","exp","Date","now","json","status","error"],"mappings":";;AAAA;AACA,IAAMA,MAAMC,QAAQ,cAAR,CAAZ;;AAEAC,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACvC,QAAIF,IAAIG,OAAJ,CAAY,eAAZ,CAAJ,EAAkC;;AAE9B,YAAIC,QAAQJ,IAAIG,OAAJ,CAAY,eAAZ,EAA6BE,KAA7B,CAAmC,GAAnC,EAAwC,CAAxC,CAAZ;AACAC,gBAAQC,GAAR,CAAYP,IAAIG,OAAJ,CAAY,eAAZ,CAAZ;AACA;AACA,YAAIK,UAAUZ,IAAIa,MAAJ,CAAWL,KAAX,CAAd;AACAE,gBAAQC,GAAR,CAAYC,OAAZ;AACA;AACA,YAAIJ,SAASI,QAAQE,GAAR,IAAeC,KAAKC,GAAL,KAAa,IAAzC,EAA+C;AAC3C,mBAAOX,IAAIY,IAAJ,CAAS;AACZC,wBAAQ,OADI;AAEZV,uBAAO,KAFK;AAGZW,uBAAO;AAHK,aAAT,CAAP;AAKH,SAND,MAMO;AACH,mBAAOd,IAAIY,IAAJ,CAAS;AACZC,wBAAQ,SADI;AAEZV,uBAAO;AAFK,aAAT,CAAP;AAIH;AACJ;;AAEDF;AACH,CAxBD","file":"checktoken.js","sourcesContent":["// 验证token\r\nconst jwt = require('jsonwebtoken')\r\n\r\nmodule.exports = function (req, res, next) {\r\n    if (req.headers['Authorization']) {\r\n\r\n        let token = req.headers['Authorization'].split(' ')[1]\r\n        console.log(req.headers['Authorization'])\r\n        //    解构token\r\n        let decoded = jwt.decode(token)\r\n        console.log(decoded)\r\n        //测试是否超时\r\n        if (token && decoded.exp <= Date.now() / 1000) {\r\n            return res.json({\r\n                status: 'ERROR',\r\n                token: false,\r\n                error: '登录超时，请重新登录！'\r\n            })\r\n        } else {\r\n            return res.json({\r\n                status: 'SUCCESS',\r\n                token: true\r\n            })\r\n        }\r\n    }\r\n\r\n    next()\r\n}"]}